#ifndef __KERN_DEF_H__
#define __KERN_DEF_H__

typedef enum _POOL_TYPE {
    NonPagedPool,
    PagedPool,
    NonPagedPoolMustSucceed,
    DontUseThisType,
    NonPagedPoolCacheAligned,
    PagedPoolCacheAligned,
    NonPagedPoolCacheAlignedMustS,
    MaxPoolType,
} POOL_TYPE;

typedef
PVOID
(NTAPI
*__fptr_ExAllocatePoolWithTag)(
    __in POOL_TYPE PoolType,
    __in SIZE_T NumberOfBytes,
    __in ULONG Tag
    );

typedef
VOID
(NTAPI
*__fptr_ExFreePoolWithTag)(
    __in PVOID P,
    __in ULONG Tag
    );

typedef
VOID
(NTAPI
*__fptr_RtlInitAnsiString)(
    __out PANSI_STRING DestinationString,
    __in_z_opt PCSZ SourceString
    );

typedef
VOID
(NTAPI
*__fptr_RtlInitUnicodeString)(
    __out PUNICODE_STRING DestinationString,
    __in_z_opt PCWSTR SourceString
    );

typedef
NTSTATUS
(NTAPI
*__fptr_RtlAnsiStringToUnicodeString)(
        PUNICODE_STRING DestinationString,
    __in PCANSI_STRING SourceString,
    __in BOOLEAN AllocateDestinationString
    );

typedef
VOID
(NTAPI
*__fptr_RtlFreeUnicodeString)(
        PUNICODE_STRING UnicodeString
    );

typedef
PVOID
(NTAPI
*__fptr_MmGetSystemRoutineAddress)(
    __in PUNICODE_STRING SystemRoutineName
    );

typedef
NTSTATUS
(NTAPI
*__fptr_ZwOpenFile)(
    __out PHANDLE FileHandle,
    __in ACCESS_MASK DesiredAccess,
    __in POBJECT_ATTRIBUTES ObjectAttributes,
    __out PIO_STATUS_BLOCK IoStatusBlock,
    __in ULONG ShareAccess,
    __in ULONG OpenOptions
    );

typedef
NTSTATUS
(NTAPI
*__fptr_ZwQueryInformationFile)(
    __in HANDLE FileHandle,
    __out PIO_STATUS_BLOCK IoStatusBlock,
    __out_bcount(Length) PVOID FileInformation,
    __in ULONG Length,
    __in FILE_INFORMATION_CLASS FileInformationClass
    );

typedef
NTSTATUS
(NTAPI
*__fptr_ZwReadFile)(
    __in HANDLE FileHandle,
    __in_opt HANDLE Event,
    __in_opt PIO_APC_ROUTINE ApcRoutine,
    __in_opt PVOID ApcContext,
    __out PIO_STATUS_BLOCK IoStatusBlock,
    __out_bcount(Length) PVOID Buffer,
    __in ULONG Length,
    __in_opt PLARGE_INTEGER ByteOffset,
    __in_opt PULONG Key
    );

typedef CCHAR KPROCESSOR_MODE;

typedef enum _MODE {
    KernelMode,
    UserMode,
    MaximumMode
} MODE;

typedef
NTSTATUS
(NTAPI
*__fptr_KeDelayExecutionThread)(
    __in KPROCESSOR_MODE WaitMode,
    __in BOOLEAN Alertable,
    __in PLARGE_INTEGER Interval
    );

typedef
NTSTATUS
(NTAPI
*__fptr_ZwClose)(
    __in HANDLE Handle
    );

typedef
void * (__cdecl *__fptr_memset)(
        void *dst,
        int val,
        size_t count
        );

typedef
void * (__cdecl *__fptr_memcpy)(
        void * dst,
        const void * src,
        size_t count
        );

#endif /* __KERN_DEF_H__ */
